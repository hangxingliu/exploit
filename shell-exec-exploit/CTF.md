# Web - Shell Execute

CTF challenge about executing shell command in.   
调用Shell(执行命令)一类Web题.

## Challenge Examples

- [challenge](env/index.php)

## LLQF (Look, Listen, Question and Feel)

1. Iterate characters to finding characters be filtered.
	- example input: `abcdefg......ABCDEFG.....`
	- maybe `cd` be filtered, ...
2. Check by inputting shell commands
	- example: `;cd`, `w`, `.../123`, `/123` ...
	- maybe display some unusual output
...

1. 输入字符集, 判断被过滤的字符
	- 例如: `abcdefg......ABCDEDG.....`
	- 出现了包括`cd`被过滤了的情况等...
2. 输入命令判断
	- 例如: `;cd`, `w`, `../123`, `/123` ...
	- 出现非正常输出
...

## Solve

1. Find commands will not be filtered.
2. Combine pipe(`|`), file I/O(`>`, `<`, `>>`, `2>`), `xargs` ...

1. 找出可用的(未被过滤)的命令/字符
2. 管道,文件IO,`xargs`...组合使用

## Exploit

1. Create WebShell php file for shell and use some tools (for example: antSword)
2. Exploit by using escape input and creating script file to getting Shell with local scripts.
3. Find some sensitive files(for example: config files).
4. Find some public port or sharing for exploiting.
5. Guess password from sensitive files.
6. Query CVE, escalate privileges.

1. 创建 WebShell PHP 文件取得shell
2. 直接利用现有输入 通过转义, 建立脚本等方法 配合本地脚本 取得shell
3. 如果是题目不是独立环境(例如docker), 可以尝试查找敏感文件,数据库等获取进一步信息
4. 如果环境是独立环境(例如docker), 可以尝试通过现有的开放端口或共享等进一步利用
5. 通过敏感文件内容猜测密码
6. 查阅CVE,利用漏洞提权.

## Defense

1. More filter rules in challenge.
2. Control user permission(www-root).
3. Put challenge in standalone environment(for example: docker)
4. Keep your OS up to date with the latest patches.

1. 在题目允许范围内加大过滤力度
2. 控制用户(www-root)权限
3. 独立环境运行题目(例如: docker)
4. 及时更新系统补丁
